# Issue #45: 뷰어 불편 사항 해결

## 목표

생성된 HTML 뷰어의 사용성을 저해하는 여러 가지 불편 사항(가독성, 하이라이트 동기화, 헤더 표시 오류 등)을 수정하여 사용자 경험을 개선합니다.

## 배경

사용자로부터 다음과 같은 불편 사항이 접수되었습니다 (Issue #45):
1. **가독성 저하**: 상단 고정 메뉴(모드, 언어 설정)가 본문을 가리거나 시야를 방해함.
2. **헤더 원문 누락**: `#`이 포함된 제목의 경우 원문이 표시되지 않는 문제.
3. **검수 모드 하이라이트**: 검수 모드에서 하이라이트가 명확하지 않고, 원문과 번역문 간의 동기화(한 줄씩 매칭)가 부족함.
4. **양방향 하이라이트**: 원문에 마우스를 올렸을 때 번역문도 같이 하이라이트되기를 원함 (현재는 번역문->원문만 되는 것으로 추정).
5. **미번역 구간**: 번역이 안 되는 부분이 존재함 (이 부분은 파싱 로직 확인 필요).

## 제안 변경 사항

### `main.py` (HTML 템플릿 및 생성 로직 수정)

#### [MODIFY] [main.py](file:///c:/github/docling-translate/main.py)

**변경 내용**:

1.  **CSS 수정 (가독성 개선)**:
    *   상단 메뉴바(`controls`)의 디자인을 개선하거나, 스크롤 시 본문을 가리지 않도록 `padding-top` 조정 또는 투명도/크기 조절.
    *   폰트 가독성 개선 (필요 시).

2.  **JS/HTML 로직 수정 (헤더 원문 표시)**:
    *   Markdown 파싱 과정에서 `#`으로 시작하는 헤더가 HTML ID나 매핑에서 제외되는지 확인하고 수정.
    *   `#` 문자가 ID 생성 시 문제를 일으키지 않도록 처리.

3.  **JS 수정 (검수 모드 및 하이라이트)**:
    *   **검수 모드(Inspection Mode)**: 마우스 오버 시 원문과 번역문의 해당 문장(또는 블록)을 동시에 하이라이트하는 로직 강화.
    *   **양방향 동기화**:
        *   번역문 Hover -> 원문 Highlight (기존 기능 개선)
        *   원문 Hover -> 번역문 Highlight (신규 추가)
    *   하이라이트 스타일(배경색 등)을 더 명확하게 변경.

4.  **미번역 이슈 디버깅**:
    *   `docling` 파싱 결과에서 누락되는 텍스트가 있는지 확인하고, 텍스트 추출 로직 보완.

## 검증 계획

### 1. 수동 테스트

**시나리오 1: 헤더 및 원문 표시 확인**
- 단계:
  1. `#`이 포함된 제목이 있는 PDF 또는 Markdown을 변환.
  2. 생성된 HTML에서 해당 제목을 클릭하거나 검수 모드로 확인.
- 예상 결과: 제목의 원문이 정상적으로 표시되어야 함.

**시나리오 2: 하이라이트 동기화 확인**
- 단계:
  1. 생성된 HTML을 열고 '검수 모드' 활성화.
  2. 번역문 문장에 마우스 오버 -> 원문 해당 문장 하이라이트 확인.
  3. 원문 문장에 마우스 오버 -> 번역문 해당 문장 하이라이트 확인.
- 예상 결과: 양방향으로 정확한 위치에 하이라이트가 표시되어야 함.

**시나리오 3: 상단 메뉴 가독성 확인**
- 단계:
  1. 문서를 스크롤하며 상단 메뉴가 본문을 가리는지 확인.
- 예상 결과: 본문 읽기에 방해가 되지 않아야 함.

### 2. 검증 체크리스트

- [ ] `#` 포함 헤더 원문 표시됨
- [ ] 검수 모드에서 양방향 하이라이트 동작함
- [ ] 상단 메뉴가 본문을 가리지 않음
- [ ] 표준 샘플(`samples/1706.03762v7.pdf`) 변환 후 HTML 동작 확인

---

*계획 작성일: 2025-11-27*
